<!DOCTYPE html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="initial-scale=1, user-scalable=no, width=device-width">
  <title>map</title>
  <link rel="stylesheet" href="../dist/css/ol.css">
  <link rel="stylesheet" href="css/index.css" type="text/css">
</head>

<body>
  <div id="map"></div>
  <script src="../dist/olmaps.js"></script>
  <script>
    
    var map = new Olmaps({
      zoom: 15
    })
    map.setMapType(0)
    map.addMarker([{
        "latitude": "39.92421163",
        "longitude": "116.39786526",
        "name": "marker-1",
        "img": "img/icon/2001.png",
        "drag": true
      },
      {
        "latitude": "39.92629634",
        "longitude": "116.39593675",
        "name": "marker-10",
      }
    ])
    map.addLine([{
        "data": [
          ["116.39786526", "39.92421163"],
          ["116.39593675", "39.92629634"]
        ],
        "color": "green",
        "textColor": "green",
        "showDistance": true,
        "type": "dash"
      },
      {
        "data": [
          ["116.39593675", "39.92629634"],
          ["116.39670252", "39.92647015"]
        ],
        "color": "red",
        "textColor": "green",
        "showDistance": false,
        "type": "line"
      },
      {
        "data": [
          ["116.39670252", "39.92647015"],
          ["116.39473110", "39.92293218"]
        ],
        "color": "green",
        "textColor": "red",
        "showDistance": true,
        "type": "line"
      }
    ])
    map.addPolygon([
      ["116.39786526", "39.92421163"],
      ["116.39670252", "39.92647015"],
      ["116.39593675", "39.92629634"],
      ["116.39473110", "39.92293218"]
    ])
    map.addCircle({
      center: [116.39786526, 39.92421163],
      radius: 100
    })

    // map.on('markerClick', function (data) {
    //   console.log(data)
    // })
    // map.on('change', function (data) {
    //   console.log(data)
    // })
    // map.on('markerDrag', function (data) {
    //   console.log(data)
    // })
    // map.calculateGroup({
    //   "data": [
    //     ["116.39786526", "39.92421163"],
    //     ["116.39593675", "39.92629634"]
    //   ],
    //   "color": "green",
    //   "textColor": "red",
    //   "showDistance": true,
    //   "type": "dash"
    // })
    const throttle = (fn, interval=300) => {
      const _self = fn
      let timer
      return function (...args) {
        if (timer) {
          return false
        }
        timer = setTimeout(() => {
          clearTimeout(timer)
          timer = null
          _self.apply(this, args)
        }, interval)
      }
    }
    map.on('change', function(data) {
      console.log(map.transProj(data.center, 'EPSG:4326', 'EPSG:3857'))
    })
    map.map.getView().on('change:resolution', throttle(function(data) {
      console.log(data)
    }))
  </script>

</body>

</html>